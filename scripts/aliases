#!/bin/bash
# Provokes and defines some aliases and functions
set -u

alias ls="ls -F --color=auto"
alias watchdir="watch -d ls -HAlF"
alias ll="ls -hl -tr -A"
alias ..="cd ../"
alias ...="cd ../../"
alias datef="date +'%d.%m.%y'"
alias python="python3"
alias pip="pip3"
alias rm="rm -ir"
alias cp="cp -i"
alias mv="mv -i"
alias dc="docker-compose"
alias killdocker="docker system prune -a"  # be CAUTIONS with this!
alias cal="ncal"
alias ccat="chroma"

# Check for system (MACOS specific stuff)
if [[ "$(uname -s)" == "Darwin" ]]; then
	alias ls="ls -GF"
	alias	bc="brew cask"
	alias updatedb="sudo /usr/libexec/locate.updatedb"
	alias vi="mvim -v"
	alias vim="mvim -v"

  # keep system up-to-date
  runbrewstuff() {
  	echo "Running brew update..."
    brew update
    brew upgrade

    echo "Running brew upgrade..."
    brew cask upgrade --greedy

    echo "Running brew cleanup..."
    rm -rf "$(brew --cache)"

    echo "Cleaning up system..."
    brew cleanup
    brew doctor

    echo "Done ;)"
  }

  # alias the open command to the finder
  finder() {
  	open "$@"
  }
fi

# reload $SHELL with -
ns() {
	exec "$SHELL" -l
}

# prune git branches
pgit() {
	git branch --merged "$(git rev-parse --abbrev-ref HEAD)" --no-color | grep -v "main\|stable" | xargs git branch -d
}

# ls all global installed npm packages
npmls() {
	npm list -g --depth=0
}

# quick alias to cd into working dir
fun() {
	cd "$HOME/fun" || return
}

# quick alias to cd into the builds dir
# containing sourced repos
builds() {
	cd "$HOME/builds" || return
}

# test and benchmark go code and check for race conditions
gobench() {
	go test -v --bench "$PWD" --benchmem -race
}

# clean modcache and cache for golang mod paths
goclean() {
	go clean -x -r -cache -modcache
}

# Taken from https://github.com/jessfraz/dotfiles/blob/main/.functions
# Thank you github.com/jessfraz
# Get colors in manual pages
man() {
	env \
		LESS_TERMCAP_mb="$(printf '\e[1;31m')" \
		LESS_TERMCAP_md="$(printf '\e[1;31m')" \
		LESS_TERMCAP_me="$(printf '\e[0m')" \
		LESS_TERMCAP_se="$(printf '\e[0m')" \
		LESS_TERMCAP_so="$(printf '\e[1;44;33m')" \
		LESS_TERMCAP_ue="$(printf '\e[0m')" \
		LESS_TERMCAP_us="$(printf '\e[1;32m')" \
		man "$@"
	}

# cd to goals dir
goals() {
	cd "$OWNCLOUD_DIR/goals" || return
}

# cd to media dir
media() {
	cd "$OWNCLOUD_DIR/media" || return
}

# cd to finances dir
fin() {
	cd "$OWNCLOUD_DIR/finances" || return
}

# cd to etc dir
etc() {
	cd "$OWNCLOUD_DIR/etc" || return
}

